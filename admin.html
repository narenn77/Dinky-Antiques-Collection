<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dinky's Collection - Admin Panel</title>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />

<style>
:root {
    --primary-color: #8B4513;
    --secondary-color: #D2B48C;
    --accent-color: #CD853F;
    --success-color: #27ae60;
    --danger-color: #e74c3c;
    --warning-color: #f39c12;
    --text-dark: #2C1810;
    --text-light: #6B4423;
    --background: #FAF8F5;
    --white: #FFFFFF;
    --gray-light: #f8f9fa;
    --gray-medium: #e9ecef;
    --shadow: rgba(139, 69, 19, 0.1);
    --border-radius: 8px;
    --transition: all 0.3s ease;
}
* {
    margin: 0; padding: 0; box-sizing: border-box;
}
body {
    font-family: 'Lato', sans-serif;
    background-color: var(--background);
    color: var(--text-dark);
    line-height: 1.6;
}
.login-container {
    display: flex;
    min-height: 100vh;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
}
.login-form {
    background: var(--white);
    padding: 3rem;
    border-radius: var(--border-radius);
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    width: 100%;
    max-width: 400px;
    text-align: center;
}
.login-form h1 {
    font-family: 'Playfair Display', serif;
    color: var(--primary-color);
    margin-bottom: 2rem;
    font-size: 2rem;
}
.form-group {
    margin-bottom: 1.5rem;
    text-align: left;
}
.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-dark);
}
.form-group input {
    width: 100%;
    padding: 1rem;
    border: 2px solid var(--gray-medium);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
}
.form-group input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
}
.login-btn {
    width: 100%;
    padding: 1rem;
    background: var(--primary-color);
    color: var(--white);
    border: none;
    border-radius: var(--border-radius);
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
}
.login-btn:hover {
    background: var(--accent-color);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px var(--shadow);
}
.error-message {
    background: var(--danger-color);
    color: var(--white);
    padding: 1rem;
    border-radius: var(--border-radius);
    margin-bottom: 1rem;
    display: none;
}
.admin-dashboard {
    display: none;
    min-height: 100vh;
}
.admin-header {
    background: var(--primary-color);
    color: var(--white);
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px var(--shadow);
}
.admin-header h1 {
    font-family: 'Playfair Display', serif;
    font-size: 1.8rem;
}
.admin-nav {
    display: flex;
    gap: 1rem;
    align-items: center;
}
.nav-btn {
    background: rgba(255,255,255,0.2);
    color: var(--white);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
    font-size: 0.9rem;
}
.nav-btn:hover {
    background: rgba(255,255,255,0.3);
}
.logout-btn {
    background: var(--danger-color);
    color: var(--white);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
}
.logout-btn:hover {
    background: #c0392b;
}
.admin-content {
    display: flex;
    min-height: calc(100vh - 80px);
}
.sidebar {
    width: 250px;
    background: var(--white);
    box-shadow: 2px 0 10px var(--shadow);
    padding: 2rem 0;
}
.sidebar-menu {
    list-style: none;
}
.sidebar-menu li {
    margin-bottom: 0.5rem;
}
.sidebar-menu a {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    padding: 1rem 2rem;
    color: var(--text-dark);
    text-decoration: none;
    transition: var(--transition);
    border-right: 3px solid transparent;
}
.sidebar-menu a:hover,
.sidebar-menu a.active {
    background: var(--gray-light);
    border-color: var(--primary-color);
    color: var(--primary-color);
}
.main-content {
    flex: 1;
    padding: 2rem;
    background: var(--background);
    overflow-y: auto;
}
.content-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    gap: 1rem;
}
.content-title {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    color: var(--primary-color);
    margin: 0;
}
.btn {
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: var(--border-radius);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
}
.btn-primary {
    background: var(--primary-color);
    color: var(--white);
}
.btn-success {
    background: var(--success-color);
    color: var(--white);
}
.btn-danger {
    background: var(--danger-color);
    color: var(--white);
}
.btn-warning {
    background: var(--warning-color);
    color: var(--white);
}
.btn-secondary {
    background: var(--gray-medium);
    color: var(--text-dark);
}
.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.table-container {
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: 0 4px 15px var(--shadow);
    overflow: hidden;
}
.table-header {
    padding: 1.5rem;
    background: var(--gray-light);
    border-bottom: 1px solid var(--gray-medium);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
}
.table-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    color: var(--primary-color);
    margin: 0;
}
.search-box {
    position: relative;
    max-width: 300px;
    flex: 1;
}
.search-box input {
    width: 100%;
    padding: 0.8rem 2.5rem 0.8rem 1rem;
    border: 2px solid var(--gray-medium);
    border-radius: var(--border-radius);
    font-size: 1rem;
}
.search-box i {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-light);
}
.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
}
.data-table th,
.data-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid var(--gray-medium);
}
.data-table th {
    background: var(--gray-light);
    font-weight: 600;
    color: var(--text-dark);
}
.data-table tbody tr:hover {
    background: var(--gray-light);
}
.item-image-small {
    width: 60px;
    height: 40px;
    object-fit: cover;
    border-radius: 4px;
}
.status-badge {
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
}
.status-mint { background: var(--success-color); color: var(--white); }
.status-excellent { background: #27ae60; color: var(--white); }
.status-fine { background: var(--warning-color); color: var(--white); }
.status-good { background: #95a5a6; color: var(--white); }
.action-buttons {
    display: flex;
    gap: 0.5rem;
}
.btn-small {
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    border-radius: 4px;
}
.form-container {
    background: var(--white);
    padding: 2rem;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 15px var(--shadow);
    max-width: 800px;
}
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}
.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}
.form-group.full-width {
    grid-column: 1 / -1;
}
.form-group label {
    font-weight: 600;
    color: var(--text-dark);
}
.form-group input,
.form-group select,
.form-group textarea {
    padding: 0.8rem;
    border: 2px solid var(--gray-medium);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
    font-family: inherit;
}
.form-group textarea {
    resize: vertical;
    min-height: 100px;
}
.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
}
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0; top: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(5px);
}
.modal-content {
    background: var(--white);
    margin: 2% auto;
    padding: 0;
    border-radius: var(--border-radius);
    max-width: 90%;
    max-height: 90%;
    overflow-y: auto;
    position: relative;
    animation: modalFadeIn 0.3s ease-out;
}
@keyframes modalFadeIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}
.modal-header {
    background: var(--primary-color);
    color: var(--white);
    padding: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.modal-title {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    margin: 0;
}
.close {
    background: none;
    border: none;
    color: var(--white);
    font-size: 2rem;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: var(--transition);
}
.close:hover {
    background: rgba(255,255,255,0.2);
}
.modal-body {
    padding: 2rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
}
.modal-image {
    width: 100%;
    height: auto;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 15px var(--shadow);
}
.modal-info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}
.info-section {
    background: var(--background);
    padding: 1rem;
    border-radius: var(--border-radius);
    border-left: 4px solid var(--accent-color);
}
.info-title {
    font-weight: 700;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}
.info-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
}
.stats-section {
    background: var(--primary-color);
    color: var(--white);
    padding: 3rem 2rem;
    text-align: center;
    margin: 3rem 0;
}
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 2rem;
    max-width: 1000px;
    margin: 0 auto;
}
.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}
.stat-number {
    font-size: 3rem;
    font-weight: 700;
    font-family: 'Playfair Display', serif;
}
.stat-label {
    font-size: 1.1rem;
    opacity: 0.9;
}
.footer {
    background: var(--text-dark);
    color: var(--white);
    padding: 3rem 2rem 2rem;
    text-align: center;
}
.footer-content {
    max-width: 1000px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
}
.footer-section h3 {
    font-family: 'Playfair Display', serif;
    margin-bottom: 1rem;
    color: var(--secondary-color);
}
.footer-section p,
.footer-section a {
    color: rgba(255,255,255,0.8);
    text-decoration: none;
    line-height: 1.8;
}
.footer-section a:hover {
    color: var(--secondary-color);
}
.social-links {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-top: 1rem;
}
.social-links a {
    width: 40px;
    height: 40px;
    background: var(--accent-color);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}
.social-links a:hover {
    background: var(--secondary-color);
    transform: translateY(-2px);
}
.footer-bottom {
    border-top: 1px solid rgba(255,255,255,0.2);
    padding-top: 1rem;
    opacity: 0.8;
}


/* responsive and utility styles omitted for brevity, please reuse your existing */

</style>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <form class="login-form" onsubmit="handleLogin(event)">
            <h1><i class="fas fa-shield-alt"></i> Admin Access</h1>
            <div id="errorMessage" class="error-message">
                Invalid credentials. Please try again.
            </div>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" required />
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required />
            </div>
            <button type="submit" class="login-btn">
                <span id="loginText">Login</span>
                <span id="loginLoading" class="loading hidden"></span>
            </button>
            <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-light);">
                Default: admin / admin123
            </div>
        </form>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-dashboard">
        <header class="admin-header">
            <h1><i class="fas fa-gem"></i> Dinky's Admin Panel</h1>
            <div class="admin-nav">
                <button class="nav-btn" onclick="exportData()"><i class="fas fa-download"></i> Export Data</button>
                <button class="nav-btn" onclick="importData()"><i class="fas fa-upload"></i> Import Data</button>
                <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </header>
        <div class="admin-content">
            <nav class="sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#" class="menu-item active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" class="menu-item" data-section="stamps"><i class="fas fa-stamp"></i> Stamps</a></li>
                    <li><a href="#" class="menu-item" data-section="coins"><i class="fas fa-coins"></i> Coins</a></li>
                    <li><a href="#" class="menu-item" data-section="currency"><i class="fas fa-money-bill-wave"></i> Currency</a></li>
                    <li><a href="#" class="menu-item" data-section="add-item"><i class="fas fa-plus"></i> Add New Item</a></li>
                    <li><a href="#" class="menu-item" data-section="countries"><i class="fas fa-flag"></i> Manage Countries</a></li>
                    <li><a href="#" class="menu-item" data-section="settings"><i class="fas fa-cog"></i> Settings</a></li>
                </ul>
            </nav>
            <main class="main-content">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="content-section">
                    <!-- Dashboard overview with stats and recent items -->
                    <div class="content-header">
                        <h2 class="content-title">Dashboard Overview</h2>
                    </div>
                    <div class="dashboard-cards">
                        <div class="dashboard-card"><div class="card-icon"><i class="fas fa-stamp"></i></div><div class="card-number" id="stampsCount">0</div><div class="card-label">Stamps</div></div>
                        <div class="dashboard-card"><div class="card-icon"><i class="fas fa-coins"></i></div><div class="card-number" id="coinsCount">0</div><div class="card-label">Coins</div></div>
                        <div class="dashboard-card"><div class="card-icon"><i class="fas fa-money-bill-wave"></i></div><div class="card-number" id="currencyCount">0</div><div class="card-label">Currency Notes</div></div>
                        <div class="dashboard-card"><div class="card-icon"><i class="fas fa-globe"></i></div><div class="card-number" id="countriesCount">0</div><div class="card-label">Countries</div></div>
                    </div>
                    <div class="table-container">
                        <div class="table-header">
                            <h3 class="table-title">Recent Items</h3>
                            <button class="btn btn-primary" onclick="showSection('add-item')"><i class="fas fa-plus"></i> Add New Item</button>
                        </div>
                        <div style="padding: 1rem;"><div id="recentItemsList">Loading recent items...</div></div>
                    </div>
                </section>

                <!-- Stamps Section -->
                <section id="stampsSection" class="content-section hidden">
                    <div class="content-header"><h2 class="content-title">Stamps Management</h2><button class="btn btn-primary" onclick="addNewItem('stamps')"><i class="fas fa-plus"></i> Add New Stamp</button></div><div id="stampsTable"></div>
                </section>

                <!-- Coins Section -->
                <section id="coinsSection" class="content-section hidden">
                    <div class="content-header"><h2 class="content-title">Coins Management</h2><button class="btn btn-primary" onclick="addNewItem('coins')"><i class="fas fa-plus"></i> Add New Coin</button></div><div id="coinsTable"></div>
                </section>

                <!-- Currency Section -->
                <section id="currencySection" class="content-section hidden">
                    <div class="content-header"><h2 class="content-title">Currency Management</h2><button class="btn btn-primary" onclick="addNewItem('currency')"><i class="fas fa-plus"></i> Add New Currency Note</button></div><div id="currencyTable"></div>
                </section>

                <!-- Add/Edit Item Section -->
                <section id="add-itemSection" class="content-section hidden">
                    <div class="content-header"><h2 id="formTitle" class="content-title">Add New Item</h2></div>
                    <div class="form-container">
                        <form id="itemForm" onsubmit="saveItem(event)">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="itemName">Name *</label>
                                    <input type="text" id="itemName" required />
                                </div>
                                <div class="form-group">
                                    <label for="itemCategory">Category *</label>
                                    <select id="itemCategory" required>
                                        <option value="">Select Category</option>
                                        <option value="stamps">Stamps</option>
                                        <option value="coins">Coins</option>
                                        <option value="currency">Currency</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="itemYear">Year *</label>
                                    <input type="number" id="itemYear" min="1000" max="2030" required />
                                </div>
                                <div class="form-group">
                                    <label for="itemCountry">Country *</label>
                                    <select id="itemCountry" required><!-- dynamically populated --></select>
                                </div>
                                <div class="form-group">
                                    <label for="itemCondition">Condition *</label>
                                    <select id="itemCondition" required>
                                        <option value="">Select Condition</option>
                                        <option value="mint">Mint</option>
                                        <option value="near-mint">Near Mint</option>
                                        <option value="excellent">Excellent</option>
                                        <option value="very-fine">Very Fine</option>
                                        <option value="fine">Fine</option>
                                        <option value="good">Good</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="itemRarity">Rarity *</label>
                                    <select id="itemRarity" required>
                                        <option value="">Select Rarity</option>
                                        <option value="common">Common</option>
                                        <option value="uncommon">Uncommon</option>
                                        <option value="rare">Rare</option>
                                        <option value="very-rare">Very Rare</option>
                                        <option value="extremely-rare">Extremely Rare</option>
                                    </select>
                                </div>
                                <div class="form-group full-width">
                                    <label for="itemImage">Image URL</label>
                                    <input type="url" id="itemImage" placeholder="https://example.com/image.jpg" />
                                </div>
                                <div class="form-group full-width">
                                    <label for="itemDescription">Description *</label>
                                    <textarea id="itemDescription" required placeholder="Brief description of the item..."></textarea>
                                </div>
                                <div class="form-group full-width">
                                    <label for="itemHistory">Historical Context</label>
                                    <textarea id="itemHistory" placeholder="Historical background and significance..."></textarea>
                                </div>
                                <div class="form-group full-width">
                                    <label for="itemNotes">Collector Notes</label>
                                    <textarea id="itemNotes" placeholder="Additional notes for collectors..."></textarea>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="cancelEdit()"><i class="fas fa-times"></i> Cancel</button>
                                <button type="submit" class="btn btn-success" id="saveBtn"><i class="fas fa-save"></i> Save Item</button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Manage Countries Section -->
                <section id="countriesSection" class="content-section hidden">
                    <div class="content-header">
                        <h2 class="content-title">Manage Countries</h2>
                        <button class="btn btn-primary" onclick="adminManager.showAddCountryForm()"><i class="fas fa-plus"></i> Add Country</button>
                    </div>
                    <div id="countriesList" class="form-container">
                        <table class="data-table" id="countriesTable">
                            <thead><tr><th>Name</th><th>Actions</th></tr></thead>
                            <tbody><!-- dynamically populated --></tbody>
                        </table>
                    </div>
                    <div id="countryFormContainer" class="form-container hidden">
                        <h3 id="countryFormTitle">Add New Country</h3>
                        <form id="countryForm" onsubmit="adminManager.saveCountry(event)">
                            <div class="form-group">
                                <label for="countryNameInput">Country Name</label>
                                <input id="countryNameInput" type="text" required />
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="adminManager.cancelCountryEdit()">Cancel</button>
                                <button type="submit" class="btn btn-success">Save</button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settingsSection" class="content-section hidden">
                    <div class="content-header"><h2 class="content-title">Settings</h2></div>
                    <div class="form-container">
                        <h3 style="margin-bottom: 1rem;">Data Management</h3>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="exportData()"><i class="fas fa-download"></i> Export All Data</button>
                            <button class="btn btn-warning" onclick="document.getElementById('importFile').click()"><i class="fas fa-upload"></i> Import Data</button>
                            <button class="btn btn-danger" onclick="clearAllData()"><i class="fas fa-trash"></i> Clear All Data</button>
                        </div>
                        <input type="file" id="importFile" accept=".json" style="display:none;" onchange="handleImportFile(event)" />
                        <h3 style="margin-bottom: 1rem;">Account Settings</h3>
                        <form onsubmit="changePassword(event)">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="currentPassword">Current Password</label>
                                    <input type="password" id="currentPassword" />
                                </div>
                                <div class="form-group">
                                    <label for="newPassword">New Password</label>
                                    <input type="password" id="newPassword" />
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary"><i class="fas fa-key"></i> Change Password</button>
                            </div>
                        </form>
                    </div>
                </section>
            </main>
        </div>
    </div>

<script>
class AdminManager {
    constructor() {
        this.currentSection = 'dashboard';
        this.currentEditId = null;
        this.currentEditCategory = null;
        this.collectionData = this.loadData();
        this.countries = this.loadCountries();
        this.currentEditingCountryIndex = null;
        this.initializeAdmin();
    }
    loadData() {
        try {
            const saved = localStorage.getItem('dinky-collection-data');
            return saved ? JSON.parse(saved) : { stamps: [], coins: [], currency: [] };
        } catch { return { stamps: [], coins: [], currency: [] }; }
    }
    saveData() {
        localStorage.setItem('dinky-collection-data', JSON.stringify(this.collectionData));
        this.updateDashboard();
    }
    loadCountries() {
        try {
            const saved = localStorage.getItem('dinky-countries');
            if (saved) return JSON.parse(saved);
            return ['USA', 'UK', 'Canada', 'Australia', 'Germany', 'France', 'Japan', 'China'];
        } catch { return []; }
    }
    saveCountries() {
        localStorage.setItem('dinky-countries', JSON.stringify(this.countries));
    }
    renderCountries() {
        const tbody = document.querySelector('#countriesTable tbody');
        tbody.innerHTML = '';
        this.countries.forEach((country, i) => {
            const tr = document.createElement('tr');
            const nameTd = document.createElement('td');
            nameTd.textContent = country;
            const actionsTd = document.createElement('td');
            const editBtn = document.createElement('button');
            editBtn.className = 'btn btn-small btn-warning';
            editBtn.innerHTML = '<i class="fas fa-edit"></i>';
            editBtn.onclick = () => this.editCountry(i);
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-small btn-danger';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.onclick = () => this.deleteCountry(i);
            actionsTd.appendChild(editBtn);
            actionsTd.appendChild(deleteBtn);
            tr.appendChild(nameTd);
            tr.appendChild(actionsTd);
            tbody.appendChild(tr);
        });
    }
    showAddCountryForm() {
        document.getElementById('countryFormTitle').textContent = 'Add New Country';
        document.getElementById('countryForm').reset();
        document.getElementById('countryFormContainer').classList.remove('hidden');
        document.getElementById('countriesList').classList.add('hidden');
        this.currentEditingCountryIndex = null;
    }
    cancelCountryEdit() {
        document.getElementById('countryFormContainer').classList.add('hidden');
        document.getElementById('countriesList').classList.remove('hidden');
        this.currentEditingCountryIndex = null;
    }
    saveCountry(event) {
        event.preventDefault();
        const countryName = document.getElementById('countryNameInput').value.trim();
        if (!countryName) {
            alert('Country name cannot be empty');
            return;
        }
        if (this.currentEditingCountryIndex !== null) {
            this.countries[this.currentEditingCountryIndex] = countryName;
        } else {
            if (this.countries.includes(countryName)) {
                alert('Country already exists');
                return;
            }
            this.countries.push(countryName);
        }
        this.saveCountries();
        this.renderCountries();
        this.cancelCountryEdit();
        window.dispatchEvent(new CustomEvent('countriesUpdated', { detail: { countries: [...this.countries] } }));
    }
    editCountry(index) {
        this.currentEditingCountryIndex = index;
        document.getElementById('countryFormTitle').textContent = 'Edit Country';
        document.getElementById('countryNameInput').value = this.countries[index];
        document.getElementById('countryFormContainer').classList.remove('hidden');
        document.getElementById('countriesList').classList.add('hidden');
    }
    deleteCountry(index) {
        if (confirm(`Are you sure you want to delete "${this.countries[index]}"?`)) {
            this.countries.splice(index, 1);
            this.saveCountries();
            this.renderCountries();
            window.dispatchEvent(new CustomEvent('countriesUpdated', { detail: { countries: [...this.countries] } }));
        }
    }
    // Implement your existing methods for item management, dashboard updates, settings, export/import, etc.
    initializeAdmin() {
        this.renderCountries();
        this.updateDashboard();
        this.showSection('dashboard');
        document.querySelectorAll('.menu-item').forEach(el => {
            el.addEventListener('click', e => {
                e.preventDefault();
                this.showSection(el.dataset.section);
            });
        });
    }
    showSection(section) {
        this.currentSection = section;
        document.querySelectorAll('.content-section').forEach(sec => sec.classList.add('hidden'));
        document.querySelectorAll('.menu-item').forEach(mi => mi.classList.remove('active'));
        const menuitem = document.querySelector(`.menu-item[data-section="${section}"]`);
        if (menuitem) menuitem.classList.add('active');
        const secEl = document.getElementById(section + 'Section');
        if (secEl) secEl.classList.remove('hidden');
    }
    updateDashboard() {
        // TODO: implement dashboard stats and recent items update here
    }
}
function handleLogin(e) {
    e.preventDefault();
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    document.getElementById('loginText').style.display = 'none';
    document.getElementById('loginLoading').classList.remove('hidden');
    setTimeout(() => {
        const savedPassword = localStorage.getItem('admin-password') || 'admin123';
        if (user === 'admin' && pass === savedPassword) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
            window.adminManager = new AdminManager();
        } else {
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('loginText').style.display = 'inline';
            document.getElementById('loginLoading').classList.add('hidden');
        }
    }, 1000);
}
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        document.getElementById('loginScreen').style.display = 'flex';
        document.getElementById('adminDashboard').style.display = 'none';
        document.getElementById('username').value = '';
        document.getElementById('password').value = '';
        document.getElementById('errorMessage').style.display = 'none';
    }
}
</script>
</body>
</html>
