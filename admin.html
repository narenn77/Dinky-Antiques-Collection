<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dinky's Collection Admin Panel</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Lato&display=swap" rel="stylesheet" />
<style>
:root {
  --primary-color: #8B4513;
  --secondary-color: #D2B48C;
  --accent-color: #CD853F;
  --success-color: #27ae60;
  --danger-color: #e74c3c;
  --warning-color: #f39c12;
  --text-dark: #2c1810;
  --text-light: #6b4423;
  --background: #faf8f5;
  --white: #ffffff;
  --gray-light: #f8f9fa;
  --gray-medium: #e9ecef;
  --shadow: rgba(139, 69, 19, 0.1);
  --border-radius: 8px;
  --transition: all 0.3s ease;
}
* {
  margin: 0; padding: 0; box-sizing: border-box;
}
body {
  font-family: 'Lato', sans-serif;
  background-color: var(--background);
  color: var(--text-dark);
  line-height: 1.6;
}
.login-container {
  display: flex;
  min-height: 100vh;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
}
.login-form {
  background: var(--white);
  padding: 3rem;
  border-radius: var(--border-radius);
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  width: 100%;
  max-width: 400px;
  text-align: center;
}
.login-form h1 {
  font-family: 'Playfair Display', serif;
  color: var(--primary-color);
  margin-bottom: 2rem;
  font-size: 2rem;
}
.form-group {
  margin-bottom: 1.5rem;
  text-align: left;
}
.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text-dark);
}
.form-group input {
  width: 100%;
  padding: 1rem;
  border: 2px solid var(--gray-medium);
  border-radius: var(--border-radius);
  font-size: 1rem;
  transition: var(--transition);
}
.form-group input:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
}
.login-btn {
  width: 100%;
  padding: 1rem;
  border: none;
  border-radius: var(--border-radius);
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  color: var(--white);
  background: var(--primary-color);
  transition: var(--transition);
}
.login-btn:hover {
  background: var(--accent-color);
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}
.error-message {
  background: var(--danger-color);
  color: var(--white);
  padding: 1rem;
  border-radius: var(--border-radius);
  margin-bottom: 1rem;
  display: none;
}
.admin-dashboard {
  display: flex;
  flex-direction: column;
  height: 100vh;
}
header.admin-header {
  background: var(--primary-color);
  color: var(--white);
  padding: 1rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 10px var(--shadow);
}
header.admin-header h1 {
  font-family: 'Playfair Display', serif;
  font-size: 1.8rem;
}
.admin-header .admin-nav > button {
  background: rgba(255, 255, 255, 0.2);
  color: var(--white);
  border: none;
  margin-left: 10px;
  padding: 0.5rem 1rem;
  border-radius: var(--border-radius);
  cursor: pointer;
  font-size: 0.9rem;
  transition: var(--transition);
}
.admin-header .admin-nav > button:hover {
  background: rgba(255, 255, 255, 0.4);
}
.admin-header .admin-nav > button.logout {
  background: var(--danger-color);
}
.admin-header .admin-nav > button.logout:hover {
  background: #c0392b;
}
.admin-header .admin-nav > button.logout:focus {
  outline: none;
}

/* Main layout */
.admin-main {
  flex: 1;
  display: flex;
  overflow: hidden;
}
.sidebar {
  width: 250px;
  background: var(--white);
  box-shadow: 2px 0 10px var(--shadow);
  padding-top: 2rem;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
}
.sidebar ul {
  list-style: none;
  padding: 0 0 20px 0;
  margin: 0;
}
.sidebar li {
  margin-bottom: 0.2rem;
}
.sidebar a {
  display: flex;
  align-items: center;
  padding: 10px 20px;
  color: var(--text-dark);
  text-decoration: none;
  border-left: 4px solid transparent;
  transition: var(--transition);
  font-weight: 600;
  cursor: pointer;
}
.sidebar a svg,
.sidebar a i {
  margin-right: 10px;
}
.sidebar a:hover,
.sidebar a.active {
  background: var(--gray-light);
  border-left-color: var(--primary-color);
  color: var(--primary-color);
}
.content {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}
.content > section {
  display: none;
}
.content > section.active {
  display: block;
}

/* Buttons */
button {
  cursor: pointer;
}
.btn {
  border-radius: var(--border-radius);
  font-weight: 700;
  padding: 10px 20px;
  border: none;
  font-size: 1rem;
  transition: var(--transition);
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}
.btn-primary {
  background: var(--primary-color);
  color: var(--white);
}
.btn-primary:hover {
  background: var(--accent-color);
}
.btn-success {
  background: var(--success-color);
  color: #fff;
}
.btn-success:hover {
  background: #219150;
}
.btn-danger {
  background: var(--danger-color);
  color: #fff;
}
.btn-danger:hover {
  background: #b63838;
}
.btn-secondary {
  background: var(--gray-medium);
  color: var(--text-dark);
}
.btn-secondary:hover {
  background: var(--gray-light);
}
.btn-small {
  padding: 4px 8px;
  font-size: 0.9rem;
}

/* Tables */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 10px 0;
}
th, td {
  text-align: left;
  padding: 12px;
  border-bottom: 1px solid var(--gray-medium);
}
th {
  background: var(--gray-light);
  font-weight: 700;
}

/* Forms */
.form-container {
  background: var(--white);
  padding: 20px;
  border-radius: var(--border-radius);
  box-shadow: 0 0 15px rgba(0,0,0,0.1);
  max-width: 800px;
}
.form-group {
  margin-bottom: 15px;
}
.form-group label {
  display: block;
  font-weight: 700;
  margin-bottom: 5px;
}
.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 10px;
  font-size: 1rem;
  border: 1px solid var(--gray-medium);
  border-radius: var(--border-radius);
  font-family: inherit;
}
.form-group textarea {
  resize: vertical;
  min-height: 100px;
}
.form-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  margin-top: 10px;
}

/* Modal */
.modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom:0;
  background: rgba(0,0,0,0.5);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 10000;
}
.modal.active {
  display: flex;
}
.modal-content {
  background: var(--white);
  border-radius: var(--border-radius);
  max-width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  padding: 20px;
  position: relative;
}
.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--gray-medium);
  margin-bottom: 10px;
}
.modal-header h3 {
  margin: 0;
  font-family: 'Playfair Display', serif;
  color: var(--primary-color);
}
.modal-close {
  font-size: 1.5rem;
  cursor: pointer;
  background: none;
  border: none;
  color: var(--primary-color);
}

/* Responsive */
@media (max-width: 768px) {
  .sidebar {
    width: 100%;
    height: auto;
    box-shadow: none;
  }
  .admin-main {
    flex-direction: column;
  }
}
</style>
<body>

<div id="loginScreen" class="login-container">
  <form class="login-form" onsubmit="handleLogin(event)">
    <h1><i class="fas fa-shield-alt"></i> Admin Access</h1>
    <div id="errorMessage" class="error-message">Invalid username or password</div>
    <div class="form-group">
      <label for="username">Username</label>
      <input id="username" autocomplete="username" required />
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input id="password" type="password" autocomplete="current-password" required />
    </div>
    <button type="submit" class="btn btn-primary">
      <span id="loginText">Login</span>
      <span id="loginLoading" class="modal-close" style="display:none;">Loading...</span>
    </button>
    <div style="margin-top:15px; font-size:14px; color:#9B6B3E;">(Default user: admin, password: admin123)</div>
  </form>
</div>

<div id="adminDashboard" class="admin-dashboard" style="display:none;">
  <header class="admin-header">
    <h1><i class="fas fa-gem"></i> Dinky's Collection Admin</h1>
    <div class="admin-nav">
      <button class="btn btn-primary" onclick="exportData()"><i class="fas fa-download"></i> Export</button>
      <button class="btn btn-primary" onclick="document.getElementById('importFile').click()"><i class="fas fa-upload"></i> Import</button>
      <button class="btn btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
    </div>
  </header>

  <div class="admin-main">
    <nav class="sidebar">
      <ul>
        <li><a href="#" class="menu-item active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
        <li><a href="#" class="menu-item" data-section="stamps"><i class="fas fa-stamp"></i> Stamps</a></li>
        <li><a href="#" class="menu-item" data-section="coins"><i class="fas fa-coins"></i> Coins</a></li>
        <li><a href="#" class="menu-item" data-section="currency"><i class="fas fa-money-bill-wave"></i> Currency</a></li>
        <li><a href="#" class="menu-item" data-section="add-item"><i class="fas fa-plus"></i> Add Item</a></li>
        <li><a href="#" class="menu-item" data-section="countries"><i class="fas fa-flag"></i> Countries</a></li>
        <li><a href="#" class="menu-item" data-section="settings"><i class="fas fa-cog"></i> Settings</a></li>
      </ul>
    </nav>

    <main class="content">
      <section id="dashboardSection" class="active">
        <h2>Dashboard</h2>
        <p>Summary and stats coming soon...</p>
      </section>

      <section id="stampsSection" class="hidden">
        <h2>Manage Stamps</h2>
        <p>Stamp management coming soon...</p>
      </section>

      <section id="coinsSection" class="hidden">
        <h2>Manage Coins</h2>
        <p>Coin management coming soon...</p>
      </section>

      <section id="currencySection" class="hidden">
        <h2>Manage Currency</h2>
        <p>Currency management coming soon...</p>
      </section>

      <section id="add-itemSection" class="hidden">
        <h2>Add/Edit Item</h2>
        <form id="itemForm" onsubmit="saveItem(event)">
          <div>
            <label>Name*</label><input id="itemName" required />
          </div>
          <div>
            <label>Category*</label>
            <select id="itemCategory" required>
              <option value="">Select</option>
              <option value="stamps">Stamps</option>
              <option value="coins">Coins</option>
              <option value="currency">Currency</option>
            </select>
          </div>
          <div>
            <label>Year*</label><input id="itemYear" type="number" required />
          </div>
          <div>
            <label>Country*</label>
            <select id="itemCountry" required></select>
          </div>
          <div>
            <label>Condition*</label>
            <select id="itemCondition" required>
              <option value="">Select</option>
              <option value="mint">Mint</option>
              <option value="near-mint">Near Mint</option>
              <option value="excellent">Excellent</option>
              <option value="very-fine">Very Fine</option>
              <option value="fine">Fine</option>
              <option value="good">Good</option>
            </select>
          </div>
          <div>
            <label>Rarity*</label>
            <select id="itemRarity" required>
              <option value="">Select</option>
              <option value="common">Common</option>
              <option value="uncommon">Uncommon</option>
              <option value="rare">Rare</option>
              <option value="very-rare">Very Rare</option>
              <option value="extremely-rare">Extremely Rare</option>
            </select>
          </div>
          <div>
            <label>Image URL</label><input id="itemImage" />
          </div>
          <div>
            <label>Description*</label><textarea id="itemDescription" required></textarea>
          </div>
          <div>
            <label>Historical Context</label><textarea id="itemHistory"></textarea>
          </div>
          <div>
            <label>Collector Notes</label><textarea id="itemNotes"></textarea>
          </div>
          <button type="submit">Save</button>
          <button type="button" onclick="cancelEdit()">Cancel</button>
        </form>
      </section>

      <section id="countriesSection" class="hidden">
        <h2>Manage Countries</h2>
        <button onclick="showAddCountry()">Add Country</button>
        <table id="countriesTable">
          <thead>
            <tr><th>Country</th><th>Actions</th></tr>
          </thead>
          <tbody></tbody>
        </table>
        <form id="countryForm" class="hidden" onsubmit="saveCountry(event)">
          <input id="countryName" required placeholder="Country Name" />
          <button type="submit">Save</button>
          <button type="button" onclick="cancelCountry()">Cancel</button>
        </form>
      </section>

      <section id="settingsSection" class="hidden">
        <h2>Settings</h2>
        <button onclick="exportData()">Export Data</button>
        <button onclick="document.getElementById('importFile').click()">Import Data</button>
        <input type="file" id="importFile" style="display:none" onchange="importFile(event)" />
        <button onclick="clearData()">Clear Data</button>
        <form onsubmit="changePassword(event)">
          <input id="currentPassword" type="password" placeholder="Current Password" />
          <input id="newPassword" type="password" placeholder="New Password" />
          <button type="submit">Change Password</button>
        </form>
      </section>
    </main>
  </div>

<script>
class AdminManager {
  constructor() {
    this.collection = { stamps: [], coins: [], currency: [] };
    this.countries = [];
    this.editItemId = null;
    this.editCountryIndex = null;
    this.loadData();
    this.loadCountries();
    this.loadWishlist();
  }

  loadData() {
    let data = localStorage.getItem("dinky-collection");
    if(data) this.collection = JSON.parse(data);
  }

  saveData() {
    localStorage.setItem("dinky-collection", JSON.stringify(this.collection));
  }

  loadCountries() {
    let data = localStorage.getItem("dinky-countries");
    if(data) this.countries = JSON.parse(data);
    else this.countries = ["USA", "UK", "Canada", "Australia", "Germany", "France", "Japan", "China"];
  }

  saveCountries() {
    localStorage.setItem("dinky-countries", JSON.stringify(this.countries));
  }

  loadWishlist() {
    let data = localStorage.getItem("dinky-wishlist");
    this.wishlist = data ? JSON.parse(data) : [];
  }

  saveWishlist() {
    localStorage.setItem("dinky-wishlist", JSON.stringify(this.wishlist));
  }

  renderTable(section) {
    let elems = this.collection[section] || [];
    let tbody = document.querySelector(`#${section}Section table tbody`);
    if (!tbody) return;
    tbody.innerHTML = "";
    elems.forEach(item => {
      let tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${item.name}</td>
        <td>${item.year}</td>
        <td>${item.country}</td>
        <td>${item.condition}</td>
        <td>${item.rarity}</td>
        <td>
          <button onclick="adminManager.editItem('${section}', '${item.id}')">Edit</button>
          <button onclick="adminManager.deleteItem('${section}', '${item.id}')">Delete</button>
        </td>`;
      tbody.appendChild(tr);
    });
  }

  renderCountries() {
    let tbody = document.querySelector("#countriesSection table tbody");
    tbody.innerHTML = "";
    this.countries.forEach((c, i) => {
      let tr = document.createElement("tr");
      tr.innerHTML = `<td>${c}</td><td>
        <button onclick="adminManager.editCountry(${i})">Edit</button>
        <button onclick="adminManager.deleteCountry(${i})">Delete</button>
      </td>`;
      tbody.appendChild(tr);
    });
  }

  showAddCountry() {
    this.editCountryIndex = null;
    document.getElementById("countryForm").reset();
    document.getElementById("countryForm").classList.remove("hidden");
    document.querySelector("#countriesSection table").classList.add("hidden");
  }

  saveCountry(e) {
    e.preventDefault();
    let countryInput = document.getElementById("countryName").value.trim();
    if(!countryInput) return alert("Country name cannot be empty");
    if(this.editCountryIndex === null){
      if(this.countries.includes(countryInput)) return alert("Country already exists");
      this.countries.push(countryInput);
    } else {
      this.countries[this.editCountryIndex] = countryInput;
    }
    this.saveCountries();
    this.renderCountries();
    document.getElementById("countryForm").classList.add("hidden");
    document.querySelector("#countriesSection table").classList.remove("hidden");
    this.editCountryIndex = null;
  }

  cancelCountry() {
    document.getElementById("countryForm").classList.add("hidden");
    document.querySelector("#countriesSection table").classList.remove("hidden");
    this.editCountryIndex = null;
  }

  editCountry(i) {
    this.editCountryIndex = i;
    document.getElementById("countryName").value = this.countries[i];
    document.getElementById("countryForm").classList.remove("hidden");
    document.querySelector("#countriesSection table").classList.add("hidden");
  }

  deleteCountry(i) {
    if(!confirm("Delete this country?")) return;
    this.countries.splice(i,1);
    this.saveCountries();
    this.renderCountries();
  }

  // ... similar methods for Items management go here ...

  editItem(category, id) {
    this.editItemId = id;
    this.editItemCategory = category;
    const item = this.collection[category].find(i => i.id === id);
    if (!item) return alert("Item not found");
    document.getElementById("itemName").value = item.name;
    document.getElementById("itemCategory").value = category;
    document.getElementById("itemYear").value = item.year;
    document.getElementById("itemCountry").value = item.country;
    document.getElementById("itemCondition").value = item.condition;
    document.getElementById("itemRarity").value = item.rarity;
    document.getElementById("itemImage").value = item.image||"";
    document.getElementById("itemDescription").value = item.description||"";
    document.getElementById("itemHistory").value = item.history||"";
    document.getElementById("itemNotes").value = item.notes||"";
    document.getElementById("add-itemSection").classList.add("active");
    this.showSection("add-item");
  }

  saveItem(e) {
    e.preventDefault();
    let item = {
      id: this.editItemId || 'item_' + Date.now(),
      name: document.getElementById("itemName").value,
      category: document.getElementById("itemCategory").value,
      year: document.getElementById("itemYear").value,
      country: document.getElementById("itemCountry").value,
      condition: document.getElementById("itemCondition").value,
      rarity: document.getElementById("itemRarity").value,
      image: document.getElementById("itemImage").value,
      description: document.getElementById("itemDescription").value,
      history: document.getElementById("itemHistory").value,
      notes: document.getElementById("itemNotes").value
    };

    if (!item.category) return alert("Select a category");

    if(this.editItemId){
      let idx = this.collection[this.editItemCategory].findIndex(i=>i.id === this.editItemId);
      if(idx !== -1){
        if(item.category !== this.editItemCategory){
          this.collection[this.editItemCategory].splice(idx,1);
          this.collection[item.category].push(item);
        } else {
          this.collection[item.category][idx] = item;
        }
      }
    } else {
      this.collection[item.category].push(item);
    }

    this.saveData();
    this.renderTable(item.category);
    this.editItemId = null;
    this.editItemCategory = null;
    this.showSection(item.category);
  }

  deleteItem(category, id) {
    if (!confirm("Delete this item?")) return;
    let idx = this.collection[category].findIndex(i => i.id === id);
    if(idx === -1) return;
    this.collection[category].splice(idx,1);
    this.saveData();
    this.renderTable(category);
  }

  cancelEdit() {
    this.editItemId = null;
    this.editItemCategory = null;
    this.showSection("dashboard");
  }
}
let adminManager;

function handleLogin(e) {
  e.preventDefault();
  let user = document.getElementById("username").value;
  let pass = document.getElementById("password").value;
  document.getElementById("loginText").style.display = "none";
  document.getElementById("loginLoading").classList.remove("hidden");
  setTimeout(() => {
    let savedPass = localStorage.getItem("admin-password") || "admin123";
    if (user === "admin" && pass === savedPass) {
      document.getElementById("loginScreen").style.display = "none";
      document.getElementById("adminDashboard").style.display = "flex";
      adminManager = new AdminManager();
    } else {
      document.getElementById("errorMessage").style.display = "block";
      document.getElementById("loginText").style.display = "inline";
      document.getElementById("loginLoading").classList.add("hidden");
    }
  }, 1000);
}
function logout() {
  if (!confirm("Logout?")) return;
  document.getElementById("loginScreen").style.display = "flex";
  document.getElementById("adminDashboard").style.display = "none";
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
  document.getElementById("errorMessage").style.display = "none";
}
function exportData() {
  if (!adminManager) return;
  let dataStr = JSON.stringify(adminManager.collection);
  let blob = new Blob([dataStr], { type: "application/json" });
  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "collection_backup_" + new Date().toISOString().slice(0,10) + ".json";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}
function handleImport(event) {
  if (!adminManager) return;
  let file = event.target.files[0];
  if (!file) return;
  let reader = new FileReader();
  reader.onload = (e) => {
    try {
      let json = JSON.parse(e.target.result);
      if (!json.stamps || !json.coins || !json.currency) throw new Error();
      adminManager.collection = json;
      adminManager.saveData();
      adminManager.renderTable('stamps');
      adminManager.renderTable('coins');
      adminManager.renderTable('currency');
      adminManager.renderTable('dashboard');
      alert("Imported successfully.");
    } catch {
      alert("Invalid data format.");
    }
  };
  reader.readAsText(file);
}
function clearData() {
  if (!adminManager) return;
  if (!confirm("This will delete ALL data. Continue?")) return;
  adminManager.collection = { stamps: [], coins: [], currency: [] };
  adminManager.saveData();
  adminManager.renderTable('stamps');
  adminManager.renderTable('coins');
  adminManager.renderTable('currency');
  adminManager.renderTable('dashboard');
  alert("Data cleared.");
}
function changePassword(e) {
  e.preventDefault();
  let current = document.getElementById("currentPassword").value;
  let newPass = document.getElementById("newPassword").value;
  let savedPass = localStorage.getItem("admin-password") || "admin123";
  if (current !== savedPass) return alert("Current password not correct.");
  if (newPass.length < 6) return alert("New password must be 6+ characters.");
  localStorage.setItem("admin-password", newPass);
  alert("Password changed.");
  e.target.reset();
}
function showAddCountry() {
  if (adminManager) adminManager.showAddCountry();
}
function saveCountry(e) {
  if (adminManager) adminManager.saveCountry(e);
}
function cancelCountry() {
  if (adminManager) adminManager.cancelCountry();
}
function editCountry(i) {
  if (adminManager) adminManager.editCountry(i);
}
function deleteCountry(i) {
  if (adminManager) adminManager.deleteCountry(i);
}
function saveItem(e) {
  if (adminManager) adminManager.saveItem(e);
}
function cancelEdit() {
  if (adminManager) adminManager.cancelEdit();
}
function editItem(category, id) {
  if (adminManager) adminManager.editItem(category, id);
}
function deleteItem(category, id) {
  if (adminManager) adminManager.deleteItem(category, id);
}
function showSection(section) {
  if (adminManager) adminManager.showSection(section);
}
function showAddItem() {
  if (adminManager) adminManager.showAddItem();
}
</script>
</body>
</html>
