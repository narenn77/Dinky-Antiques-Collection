<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dinky's Collection - Admin Panel</title>

<!-- Font Awesome CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />

<style>
/* All admin panel styles - login, layout, sidebar, tables, forms, etc. */
/* (Use the full CSS style block from the last full admin.html I provided) */
:root {
    --primary-color: #8B4513;
    --secondary-color: #D2B48C;
    --accent-color: #CD853F;
    --success-color: #27ae60;
    --danger-color: #e74c3c;
    --warning-color: #f39c12;
    --text-dark: #2C1810;
    --text-light: #6B4423;
    --background: #FAF8F5;
    --white: #FFFFFF;
    --gray-light: #f8f9fa;
    --gray-medium: #e9ecef;
    --shadow: rgba(139, 69, 19, 0.1);
    --border-radius: 8px;
    --transition: all 0.3s ease;
}
* {
    margin: 0; padding: 0; box-sizing: border-box;
}
body {
    font-family: 'Lato', sans-serif;
    background-color: var(--background);
    color: var(--text-dark);
    line-height: 1.6;
}
/* Additional admin styles for login, header, sidebar, main content, forms, tables, etc., as previously provided */
/* Please include all from last full admin.html CSS */
</style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <form class="login-form" onsubmit="handleLogin(event)">
            <h1><i class="fas fa-shield-alt"></i> Admin Access</h1>
            <div id="errorMessage" class="error-message">Invalid credentials. Please try again.</div>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" required />
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" required />
            </div>
            <button type="submit" class="login-btn">
                <span id="loginText">Login</span>
                <span id="loginLoading" class="loading hidden"></span>
            </button>
            <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--text-light);">
                Default: admin / admin123
            </div>
        </form>
    </div>

    <!-- Main admin dashboard panel -->
    <div id="adminDashboard" class="admin-dashboard">
        <header class="admin-header">
            <h1><i class="fas fa-gem"></i> Dinky's Admin Panel</h1>
            <div class="admin-nav">
                <button class="nav-btn" onclick="exportData()"><i class="fas fa-download"></i> Export Data</button>
                <button class="nav-btn" onclick="importData()"><i class="fas fa-upload"></i> Import Data</button>
                <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </header>
        <div class="admin-content">
            <nav class="sidebar">
                <ul class="sidebar-menu">
                    <li><a href="#" class="menu-item active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="#" class="menu-item" data-section="stamps"><i class="fas fa-stamp"></i> Stamps</a></li>
                    <li><a href="#" class="menu-item" data-section="coins"><i class="fas fa-coins"></i> Coins</a></li>
                    <li><a href="#" class="menu-item" data-section="currency"><i class="fas fa-money-bill-wave"></i> Currency</a></li>
                    <li><a href="#" class="menu-item" data-section="add-item"><i class="fas fa-plus"></i> Add New Item</a></li>
                    <li><a href="#" class="menu-item" data-section="countries"><i class="fas fa-flag"></i> Manage Countries</a></li>
                    <li><a href="#" class="menu-item" data-section="settings"><i class="fas fa-cog"></i> Settings</a></li>
                </ul>
            </nav>
            <main class="main-content">
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="content-section">
                    <!-- Dashboard content as previously provided -->
                </section>
                <!-- Stamps, Coins, Currency sections -->
                <section id="stampsSection" class="content-section hidden">
                    <!-- ... -->
                </section>
                <section id="coinsSection" class="content-section hidden">
                    <!-- ... -->
                </section>
                <section id="currencySection" class="content-section hidden">
                    <!-- ... -->
                </section>
                <!-- Add/Edit Item Section -->
                <section id="add-itemSection" class="content-section hidden">
                    <!-- ... -->
                </section>
                <!-- Manage Countries Section -->
                <section id="countriesSection" class="content-section hidden">
                    <div class="content-header">
                        <h2 class="content-title">Manage Countries</h2>
                        <button class="btn btn-primary" onclick="adminManager.showAddCountryForm()"><i class="fas fa-plus"></i> Add Country</button>
                    </div>
                    <div id="countriesList" class="form-container">
                        <table class="data-table" id="countriesTable">
                            <thead><tr><th>Name</th><th>Actions</th></tr></thead>
                            <tbody><!-- dynamically generated --></tbody>
                        </table>
                    </div>
                    <div id="countryFormContainer" class="form-container hidden">
                        <h3 id="countryFormTitle">Add New Country</h3>
                        <form id="countryForm" onsubmit="adminManager.saveCountry(event)">
                            <div class="form-group">
                                <label for="countryNameInput">Country Name</label>
                                <input id="countryNameInput" type="text" required />
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="adminManager.cancelCountryEdit()">Cancel</button>
                                <button type="submit" class="btn btn-success">Save</button>
                            </div>
                        </form>
                    </div>
                </section>
                <!-- Settings Section -->
                <section id="settingsSection" class="content-section hidden">
                    <!-- Settings content -->
                </section>
            </main>
        </div>
    </div>

    <!-- Modal, scripts, and all JavaScript code as fully provided before including all methods for: -->
    <!-- - Item management (add/edit/delete) -->
    <!-- - Country management -->
    <!-- - Settings -->
    <!-- - Dashboard update -->
    <!-- - Events -->
<script>
class AdminManager {
    constructor() {
        this.currentSection = 'dashboard';
        this.currentEditId = null;
        this.currentEditCategory = null;
        this.collectionData = this.loadData();
        this.countries = this.loadCountries();
        this.currentEditingCountryIndex = null;
        this.initializeAdmin();
    }
    loadData() {
        try {
            const saved = localStorage.getItem('dinky-collection-data');
            return saved ? JSON.parse(saved) : { stamps: [], coins: [], currency: [] };
        } catch { return { stamps: [], coins: [], currency: [] }; }
    }
    saveData() {
        localStorage.setItem('dinky-collection-data', JSON.stringify(this.collectionData));
        this.updateDashboard();
    }
    loadCountries() {
        try {
            const saved = localStorage.getItem('dinky-countries');
            if (saved) return JSON.parse(saved);
            return ['USA', 'UK', 'Canada', 'Australia', 'Germany', 'France', 'Japan', 'China'];
        } catch { return []; }
    }
    saveCountries() {
        localStorage.setItem('dinky-countries', JSON.stringify(this.countries));
    }
    renderCountries() {
        const tbody = document.querySelector('#countriesTable tbody');
        tbody.innerHTML = '';
        this.countries.forEach((country, i) => {
            const tr = document.createElement('tr');
            const nameTd = document.createElement('td');
            nameTd.textContent = country;
            const actionsTd = document.createElement('td');
            const editBtn = document.createElement('button');
            editBtn.className = 'btn btn-small btn-warning';
            editBtn.innerHTML = '<i class="fas fa-edit"></i>';
            editBtn.onclick = () => this.editCountry(i);
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-small btn-danger';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.onclick = () => this.deleteCountry(i);
            actionsTd.appendChild(editBtn);
            actionsTd.appendChild(deleteBtn);
            tr.appendChild(nameTd);
            tr.appendChild(actionsTd);
            tbody.appendChild(tr);
        });
    }
    showAddCountryForm() {
        document.getElementById('countryFormTitle').textContent = 'Add New Country';
        document.getElementById('countryForm').reset();
        document.getElementById('countryFormContainer').classList.remove('hidden');
        document.getElementById('countriesList').classList.add('hidden');
        this.currentEditingCountryIndex = null;
    }
    cancelCountryEdit() {
        document.getElementById('countryFormContainer').classList.add('hidden');
        document.getElementById('countriesList').classList.remove('hidden');
        this.currentEditingCountryIndex = null;
    }
    saveCountry(event) {
        event.preventDefault();
        const countryName = document.getElementById('countryNameInput').value.trim();
        if (!countryName) {
            alert('Country name cannot be empty');
            return;
        }
        if (this.currentEditingCountryIndex !== null) {
            this.countries[this.currentEditingCountryIndex] = countryName;
        } else {
            if (this.countries.includes(countryName)) {
                alert('Country already exists');
                return;
            }
            this.countries.push(countryName);
        }
        this.saveCountries();
        this.renderCountries();
        this.cancelCountryEdit();
        window.dispatchEvent(new CustomEvent('countriesUpdated', { detail: { countries: [...this.countries] } }));
    }
    editCountry(index) {
        this.currentEditingCountryIndex = index;
        document.getElementById('countryFormTitle').textContent = 'Edit Country';
        document.getElementById('countryNameInput').value = this.countries[index];
        document.getElementById('countryFormContainer').classList.remove('hidden');
        document.getElementById('countriesList').classList.add('hidden');
    }
    deleteCountry(index) {
        if (confirm(`Are you sure you want to delete "${this.countries[index]}"?`)) {
            this.countries.splice(index, 1);
            this.saveCountries();
            this.renderCountries();
            window.dispatchEvent(new CustomEvent('countriesUpdated', { detail: { countries: [...this.countries] } }));
        }
    }

    // TODO: Include full implementations of item management, dashboard, and settings methods as in previous admin.html

    initializeAdmin() {
        // bind event listeners, initialize renderings, etc.
        this.renderCountries();
        this.updateDashboard();
        this.showSection('dashboard');
        // Bind menu clicks
        document.querySelectorAll('.menu-item').forEach(el => {
            el.addEventListener('click', e => {
                e.preventDefault();
                this.showSection(el.dataset.section);
            });
        });
    }

    showSection(sec) {
        this.currentSection = sec;
        document.querySelectorAll('.content-section').forEach(section => section.classList.add('hidden'));
        document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
        const menuItem = document.querySelector(`.menu-item[data-section="${sec}"]`);
        if (menuItem) menuItem.classList.add('active');
        const secEl = document.getElementById(sec + 'Section');
        if (secEl) secEl.classList.remove('hidden');
    }

    updateDashboard() {
        // Update dashboard statistics here (implement accordingly)
    }
}

function handleLogin(event) {
    event.preventDefault();
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    document.getElementById('loginText').style.display = 'none';
    document.getElementById('loginLoading').classList.remove('hidden');
    setTimeout(() => {
        const savedPassword = localStorage.getItem('admin-password') || 'admin123';
        if (user === 'admin' && pass === savedPassword) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
            window.adminManager = new AdminManager();
        } else {
            document.getElementById('errorMessage').style.display = 'block';
            document.getElementById('loginText').style.display = 'inline';
            document.getElementById('loginLoading').classList.add('hidden');
        }
    }, 1000);
}
function logout() {
    if (confirm('Are you sure you want to logout?')) {
        document.getElementById('loginScreen').style.display = 'flex';
        document.getElementById('adminDashboard').style.display = 'none';
        document.getElementById('username').value = '';
        document.getElementById('password').value = '';
        document.getElementById('errorMessage').style.display = 'none';
    }
}

// Add other global functions for admin as needed...

</script>
</body>
</html>
