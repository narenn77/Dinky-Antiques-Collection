<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dinky's Admin Panel</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Lato&display=swap" rel="stylesheet" />
<style>
  :root {
    --primary-color: #8b4513;
    --secondary-color: #d2b48c;
    --accent-color: #cd853f;
    --success-color: #27ae60;
    --danger-color: #e74c3c;
    --text-dark: #2c1810;
    --text-light: #6b4423;
    --background: #faf8f5;
    --white: #ffffff;
    --gray-light: #f8f9fa;
    --gray-medium: #e9ecef;
    --shadow: rgba(139,69,19,0.1);
    --border-radius: 8px;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Lato', sans-serif;
    background: var(--background);
    color: var(--text-dark);
    line-height: 1.5;
  }
  .hidden { display: none !important; }
  #loginScreen {
    height: 100vh;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #loginForm {
    background: var(--white);
    padding: 3rem;
    border-radius: var(--border-radius);
    width: 350px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    text-align: center;
  }
  #loginForm h2 {
    font-family: 'Playfair Display', serif;
    margin-bottom: 1.5rem;
    color: var(--primary-color);
  }
  #loginForm label {
    font-weight: 700;
    display: block;
    margin: 1rem 0 0.5rem;
    text-align: left;
  }
  #loginForm input {
    width: 100%;
    padding: 0.7rem 1rem;
    font-size: 1rem;
    border-radius: var(--border-radius);
    border: 2px solid var(--gray-medium);
    transition: border-color 0.3s ease;
  }
  #loginForm input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 5px var(--primary-color);
  }
  #loginForm button {
    margin-top: 1.5rem;
    width: 100%;
    padding: 1rem;
    border:none;
    border-radius: var(--border-radius);
    background: var(--primary-color);
    color: var(--white);
    font-size: 1.1rem;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #loginForm button:hover {
    background: var(--accent-color);
  }
  #loginError {
    margin-top: 1rem;
    color: var(--danger-color);
    font-weight: 700;
    display: none;
  }

  #adminPanel {
    display: none;
    height: 100vh;
    display: flex;
    flex-direction: column;
  }
  header {
    padding: 1rem 2rem;
    background: var(--primary-color);
    color: var(--white);
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 5px 15px var(--shadow);
  }
  header h1 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
  }
  header .controls button {
    background: transparent;
    border: 1.5px solid var(--white);
    border-radius: 6px;
    color: var(--white);
    padding: 0.5rem 1rem;
    margin-left: 10px;
    cursor: pointer;
    font-weight: 700;
    transition: background 0.3s ease, color 0.3s ease;
  }
  header .controls button:hover {
    background: var(--white);
    color: var(--primary-color);
  }
  header .controls button.logout {
    border-color: var(--danger-color);
    color: var(--danger-color);
  }
  header .controls button.logout:hover {
    background: var(--danger-color);
    color: var(--white);
  }

  .main {
    flex: 1;
    display: flex;
    overflow: hidden;
  }
  nav.sidebar {
    width: 240px;
    background: var(--white);
    padding: 2rem 1rem;
    box-shadow: 2px 0 10px var(--shadow);
    overflow-y: auto;
  }
  nav.sidebar button {
    width: 100%;
    background: none;
    border: none;
    text-align: left;
    font-weight: 700;
    padding: 0.8rem 1rem;
    margin-bottom: 0.5rem;
    color: var(--text-dark);
    cursor: pointer;
    border-left: 5px solid transparent;
    transition: background 0.3s, border-color 0.3s;
    font-size: 1rem;
  }
  nav.sidebar button:hover,
  nav.sidebar button.active {
    background: var(--gray-light);
    border-left-color: var(--primary-color);
    color: var(--primary-color);
  }

  main.content {
    flex: 1;
    padding: 2rem;
    overflow-y: auto;
  }
  main.content > section {
    display: none;
  }
  main.content > section.active {
    display: block;
  }

  button.action {
    cursor: pointer;
    border-radius: 6px;
    padding: 8px 16px;
    font-weight: 600;
    background: var(--primary-color);
    color: white;
    border: none;
    transition: background 0.3s ease;
  }
  button.action:hover {
    background: var(--accent-color);
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    border: 1px solid var(--gray-medium);
    padding: 0.5rem;
    text-align: left;
  }
  th {
    background: var(--gray-light);
    font-weight: 700;
  }
  /* Form styles */
  form label {
    display: block;
    margin-top: 1rem;
  }
  form input, form select, form textarea {
    width: 100%;
    padding: 0.6rem;
    margin-top: 0.3rem;
    border: 1.5px solid var(--gray-medium);
    border-radius: 6px;
    font-size: 1rem;
  }
  form textarea {
    resize: vertical;
  }
  form button {
    margin-top: 1.5rem;
    padding: 10px 20px;
  }
  .hidden {
    display: none !important;
  }
</style>
</head>
<body>

<div id="loginScreen">
  <form id="loginForm">
    <h2>Admin Login</h2>
    <div id="loginError"></div>
    <label>Username<input id="username" required></label>
    <label>Password<input id="password" type="password" required></label>
    <button type="submit">Login</button>
    <p><small>Default: admin / admin123</small></p>
  </form>
</div>

<div id="adminPanel" class="hidden">
  <header>
    <h1><i class="fas fa-gem"></i> Dinky's Admin Panel</h1>
    <div class="controls">
      <button id="exportBtn">Export Data</button>
      <button id="importBtn">Import Data</button>
      <button id="logoutBtn" class="logout">Logout</button>
      <input type="file" id="importFile" style="display:none" accept=".json" />
    </div>
  </header>
  <div class="main">
    <nav class="sidebar">
      <button class="menu-item active" data-section="dashboardSection">Dashboard</button>
      <button class="menu-item" data-section="itemsSection">Items</button>
      <button class="menu-item" data-section="countriesSection">Countries</button>
      <button class="menu-item" data-section="settingsSection">Settings</button>
    </nav>
    <main class="content">
      <section id="dashboardSection" class="active">
        <h2>Dashboard</h2>
        <p>Welcome to your admin dashboard.</p>
      </section>
      
      <section id="itemsSection" class="hidden">
        <h2>Items</h2>
        <button id="showAddItemBtn" class="action">Add New Item</button>
        <ul id="itemsList"></ul>
        <div id="itemFormContainer" class="hidden">
          <h3 id="itemFormTitle">Add Item</h3>
          <form id="itemForm">
            <label>Name<input id="itemName" required /></label>
            <label>Category
              <select id="itemCategory" required>
                <option value="">Select</option>
                <option value="Stamp">Stamp</option>
                <option value="Coin">Coin</option>
              </select>
            </label>
            <label>Country
              <select id="itemCountry" required></select>
            </label>
            <label>
              <button type="submit" class="action">Save</button>
              <button type="button" id="cancelItemBtn" class="action">Cancel</button>
            </label>
          </form>
        </div>
      </section>
      
      <section id="countriesSection" class="hidden">
        <h2>Countries</h2>
        <button id="showAddCountryBtn" class="action">Add New Country</button>
        <ul id="countriesList"></ul>
        <div id="countryFormContainer" class="hidden">
          <h3 id="countryFormTitle">Add Country</h3>
          <form id="countryForm">
            <label>Name<input id="countryName" required /></label>
            <label>
              <button type="submit" class="action">Save</button>
              <button type="button" id="cancelCountryBtn" class="action">Cancel</button>
            </label>
          </form>
        </div>
      </section>
      
      <section id="settingsSection" class="hidden">
        <h2>Settings</h2>
        <button id="clearDataBtn" class="action">Clear All Data</button>
        <form id="passwordForm">
          <label>Current Password<input type="password" id="currentPass" /></label>
          <label>New Password<inputtype="password" id="newPass" /></label>
          <label>
            <button type="submit" class="action">Change Password</button>
          </label>
        </form>
      </section>
    </main>
  </div>
</div>

<script>
  let collection = { stamps: [], coins: [] };
  let countries = ['USA', 'UK', 'France', 'Germany', 'Japan'];
  let editingItemIndex = null;
  let editingCountryIndex = null;

  // DOM Elements
  const loginScreen = document.getElementById('loginScreen');
  const adminPanel = document.getElementById('adminPanel');
  const loginForm = document.getElementById('loginForm');
  const loginError = document.getElementById('loginError');

  const menuButtons = document.querySelectorAll('.sidebar .menu-item');
  const sections = document.querySelectorAll('main .content > section');

  const itemsSection = document.getElementById('itemsSection');
  const itemsList = document.getElementById('itemsList');
  const itemFormContainer = document.getElementById('itemFormContainer');
  const itemForm = document.getElementById('itemForm');
  const itemName = document.getElementById('itemName');
  const itemCategory = document.getElementById('itemCategory');
  const itemCountry = document.getElementById('itemCountry');
  const showAddItemBtn = document.getElementById('showAddItemBtn');
  const cancelItemBtn = document.getElementById('cancelItemBtn');

  const countriesSection = document.getElementById('countriesSection');
  const countriesList = document.getElementById('countriesList');
  const countryFormContainer = document.getElementById('countryFormContainer');
  const countryForm = document.getElementById('countryForm');
  const countryName = document.getElementById('countryName');
  const showAddCountryBtn = document.getElementById('showAddCountryBtn');
  const cancelCountryBtn = document.getElementById('cancelCountryBtn');

  const clearDataBtn = document.getElementById('clearDataBtn');
  const passwordForm = document.getElementById('passwordForm');
  const currentPass = document.getElementById('currentPass');
  const newPass = document.getElementById('newPass');

  // Utility Functions
  function showSection(id) {
    sections.forEach(sec => sec.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
    menuButtons.forEach(btn => btn.classList.remove('active'));
    document.querySelector(`.sidebar .menu-item[data-section="${id}"]`).classList.add('active');
  }

  function saveToLocalStorage() {
    localStorage.setItem('collection', JSON.stringify(collection));
    localStorage.setItem('countries', JSON.stringify(countries));
  }
  function loadFromLocalStorage() {
    const storedCollection = localStorage.getItem('collection');
    if (storedCollection) {
      collection = JSON.parse(storedCollection);
    }
    const storedCountries = localStorage.getItem('countries');
    if (storedCountries) {
      countries = JSON.parse(storedCountries);
    }
  }

  // Login Handling
  loginForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = loginForm.username.value.trim();
    const password = loginForm.password.value.trim();
    const savedPass = localStorage.getItem('adminPass') || 'admin123';

    if (username === 'admin' && password === savedPass) {
      loginScreen.style.display = 'none';
      adminPanel.style.display = 'flex';
      initAdmin();
    } else {
      loginError.textContent = 'Invalid username or password';
      loginError.style.display = 'block';
    }
  });

  // Initialize Admin Panel
  function initAdmin() {
    loadFromLocalStorage();
    renderMenu();
    renderItems();
    renderCountries();
    populateCountrySelect();
    showSection('dashboardSection');
  }

  // Sidebar Menu Event Listeners
  menuButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      showSection(btn.dataset.section);
      resetForms();
    });
  });

  // Render Items
  function renderItems() {
    itemsList.innerHTML = '';
    ['stamps', 'coins'].forEach(category => {
      collection[category].forEach((item, idx) => {
        const li = document.createElement('li');
        li.textContent = `${item.name} (${category})`;
        const editBtn = document.createElement('button');
        editBtn.textContent = 'Edit';
        editBtn.addEventListener('click', () => editItem(category, idx));
        const delBtn = document.createElement('button');
        delBtn.textContent = 'Delete';
        delBtn.addEventListener('click', () => deleteItem(category, idx));
        li.appendChild(editBtn);
        li.appendChild(delBtn);
        itemsList.appendChild(li);
      });
    });
  }

  // Render Countries
  function renderCountries() {
    countriesList.innerHTML = '';
    countries.forEach((country, idx) => {
      const li = document.createElement('li');
      li.textContent = country;
      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.addEventListener('click', () => editCountry(idx));
      const delBtn = document.createElement('button');
      delBtn.textContent = 'Delete';
      delBtn.addEventListener('click', () => deleteCountry(idx));
      li.appendChild(editBtn);
      li.appendChild(delBtn);
      countriesList.appendChild(li);
    });
  }

  // Populate Country Select in Item Form
  function populateCountrySelect() {
    itemCountry.innerHTML = '<option value="">Select country</option>';
    countries.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c;
      opt.textContent = c;
      itemCountry.appendChild(opt);
    });
  }

  // Show Add Item Form
  showAddItemBtn.addEventListener('click', () => {
    resetForms();
    itemFormContainer.classList.remove('hidden');
    showSection('itemsSection');
  });

  cancelItemBtn.addEventListener('click', () => {
    resetForms();
  });

  // Save Item
  itemForm.addEventListener('submit', e => {
    e.preventDefault();
    const item = {
      id: currentItemEdit?.id || `${Date.now()}`,
      name: itemName.value.trim(),
      category: itemCategory.value,
      country: itemCountry.value
    };
    if (!item.name || !item.category || !item.country) {
      alert('Please fill required fields');
      return;
    }
    if (currentItemEdit) {
      collection[currentItemEdit.category][currentItemEdit.index] = item;
    } else {
      collection[item.category].push(item);
    }
    saveToLocalStorage();
    renderItems();
    resetForms();
  });

  // Edit Item
  function editItem(category, idx) {
    currentItemEdit = { category, index: idx, id: collection[category][idx].id };
    itemName.value = collection[category][idx].name;
    itemCategory.value = category;
    itemCountry.value = collection[category][idx].country;
    itemFormContainer.classList.remove('hidden');
    showSection('itemsSection');
  }

  // Delete Item
  function deleteItem(category, idx) {
    if (confirm('Delete this item?')) {
      collection[category].splice(idx, 1);
      saveToLocalStorage();
      renderItems();
    }
  }

  // Show Add Country Form
  showAddCountryBtn.addEventListener('click', () => {
    resetForms();
    countryFormContainer.classList.remove('hidden');
    showSection('countriesSection');
  });

  cancelCountryBtn.addEventListener('click', () => {
    resetForms();
  });

  // Save Country
  countryForm.addEventListener('submit', e => {
    e.preventDefault();
    const val = countryName.value.trim();
    if (!val) {
      alert('Please enter a country name');
      return;
    }
    if (currentCountryEdit !== null) {
      countries[currentCountryEdit] = val;
    } else {
      if (countries.includes(val)) {
        alert('Country already exists');
        return;
      }
      countries.push(val);
    }
    saveToLocalStorage();
    renderCountries();
    resetForms();
  });

  // Edit Country
  function editCountry(idx) {
    currentCountryEdit = idx;
    countryName.value = countries[idx];
    countryFormContainer.classList.remove('hidden');
    countriesSection.querySelector('ul').classList.add('hidden');
  }

  // Delete Country
  function deleteCountry(idx) {
    if (confirm('Delete this country?')) {
      countries.splice(idx, 1);
      saveToLocalStorage();
      renderCountries();
    }
  }

  // Clear Data Button
  clearDataBtn.addEventListener('click', () => {
    if (confirm('Clear all stored data?')) {
      collection = { stamps: [], coins: [] };
      countries = [];
      saveToLocalStorage();
      renderItems();
      renderCountries();
    }
  });

  // Change Password Form
  passwordForm.addEventListener('submit', e => {
    e.preventDefault();
    const curr = currentPass.value;
    const nw = newPass.value;
    const savedPass = localStorage.getItem('adminPass') || 'admin123';
    if (curr !== savedPass) {
      alert('Current password incorrect');
      return;
    }
    if (!nw || nw.length < 6) {
      alert('New password must be at least 6 characters');
      return;
    }
    localStorage.setItem('adminPass', nw);
    alert('Password changed successfully');
    passwordForm.reset();
  });

  // Reset forms helper
  function resetForms() {
    currentItemEdit = null;
    currentCountryEdit = null;
    itemFormContainer.classList.add('hidden');
    countryFormContainer.classList.add('hidden');
    countriesSection.querySelector('ul').classList.remove('hidden');
    showSection('dashboardSection');
  }
</script>
</body>
</html>
